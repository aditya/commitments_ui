<div ng-controller="Discussion" class="discussion">
    <ul
        editable-list="newcomment"
        editable-list-nested
        editable-list-blank-record
        ng-model="task.discussion.comments" class="container-fluid unstyled comments">
        <li
        ng-repeat="comment in task.discussion.comments"
        class="row-fluid comment">
        <table
            editable-record="updatecomment"
            ng-model="comment"
            class="full-width">
            <tr>
                <td class="comment-gravatar">
                    <div gravatar="comment.who" default="user.email"></div>
                </td>
                <td class="fill">
                    <table>
                        <tr>
                            <td class="fill">
                                <span username ng-model="comment.who" default="user.email"></span>
                                <span postdate ng-model="comment.when"></span>
                            </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="fill"
                                <div
                                    markdown multiline
                                    search-highlight="searchQuery"
                                    readonly-if="(user.email != comment.who) || readonly"
                                    ng-model="comment.what">
                                </div>
                            </td>
                            <td animated-visible="hover && (user.email == comment.who)" class="task-action">
                                <span action="deleterecord" ng-hide="readonly" tooltip="'Delete this comment'"><i class="icon-trash"></i></span>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        </li>
        <li class="row-fluid comment" ng-hide="readonly">
        <table
            editable-record
            editable-record-placeholder
            ng-model="$$placeholder" class="full-width">
            <tr>
                <td class="comment-gravatar">
                    <div
                        gravatar="comment.who"
                        default="user.email"></div>
                </td>
                <td class="fill">
                    <div
                        markdown
                        multiline
                        placeholder="'Your comment here'"
                        ng-model="$$placeholder.what">
                    </div>
                </td>
            </tr>
        </table>
        </li>
    </ul>
</div>
